var Mongoose = require('../db');

var Schema = Mongoose.Schema;

var CmdSchema = new Schema({

	infoType: 		{type: Number, default: 12},
	address:   		String,
	midAddress:     String,
	command: 	    Schema.Types.Mixed,
	createdAt:  	{type: Date, default: Date.now}
});

var commands = Mongoose.InnotekTobaccoDb.model('commands', CmdSchema);

module.exports.addCommand = function(options, doc, res, isSendResponse){

 	commands.findOneAndUpdate(options, doc, {upsert: true}, function(err, data){
						   
    		if (err && isSendResponse)
            {
                res.writeHead(404);
                res.write("失败");
                res.end();    			    			
    		}
            else if (isSendResponse)
            {    		
    			res.writeHead(200);
                res.write("成功");
                res.end();;
    		}
 	});	
};